<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>PAâ€™ MI CASA</title>
  <link rel="stylesheet" href="styles.css" />
  <link rel="stylesheet" href="responsive.css" />
</head>
<body>

  <!-- HEADER -->
  <header class="main-header">
    <img src="banner.jpg" alt="PA' MI CASA Banner" class="header-banner" />
    <div class="header-overlay">
      <div id="provincia-info" class="provincia-info"></div>
      <div class="header-actions">
        <button class="menu-toggle" onclick="toggleMenu()">â˜°</button>
        <a href="cart.html" class="cart-icon">
          ðŸ›’ <span id="cart-count">0</span>
        </a>
      </div>
    </div>

    <!-- MenÃº lateral -->
    <nav class="side-menu" id="sideMenu">
      <a href="index.html">Home</a>
      <a href="Products.html">Productos</a>
      <a href="gestor.html">Quiero ser Gestor</a>
      <a href="#Global Imports">Global Imports</a>
      <a href="remesas/remesas.html">Remesas</a>
      <a href="#reviews">Reviews</a>
      <a href="#contact">Contact</a>
    </nav>
    <div class="overlay" id="overlay" onclick="toggleMenu()"></div>
  </header>

  <!-- Banner de Bienvenida -->
  <section class="hero-banner">
    <img src="img/Bienvenido.jpg" alt="Bienvenida a PA MI CASA" class="full-banner-img">
  </section>

  <!-- FEATURES -->
  <section class="features">
    <div class="feature">âœ… Quality Guaranteed</div>
    <div class="feature">ðŸšš Fast Shipping</div>
    <div class="feature">ðŸ’¬ Personalized Support</div>
  </section>

  <!-- PRODUCTS -->
  <section id="products" class="products">
    <h2>Featured Products</h2>
    <div class="filter-bar"></div>
    <section id="product-container" class="product-grid">
      <!-- AquÃ­ se insertan los productos dinÃ¡micamente -->
    </section>
  </section>

  <!-- CART DISPLAY -->
  <section id="cart-display" class="cart-section">
    <h1>Your Cart</h1>
    <div id="cart-items"></div>
  </section>

  <!-- REVIEWS -->
  <section id="reviews" class="reviews">
    <h2>Customer Reviews</h2>
    <div class="review">"Excellent service and product quality." â€“ Emir</div>
    <div class="review">"Fast delivery and great packaging." â€“ Laura</div>
    <div class="review">"Very helpful support." â€“ Carlos</div>
  </section>

  <!-- FOOTER -->
  <footer>
    <div class="social-links">
      <a href="#">Facebook</a> |
      <a href="#">Instagram</a> |
      <a href="#">WhatsApp</a>
    </div>
    <p>Â© 2025 PAâ€™ MI CASA. Todos los derechos reservados.</p>
  </footer>

  <!-- SCRIPTS -->
  <script src="main.js"></script>
  <script src="cart.js"></script>
  <script src="ubicacion.js"></script>
  <script src="ref-manager.js"></script>
  <script src="productos.js"></script>

  <script>
    document.addEventListener("DOMContentLoaded", () => {
      const ref = localStorage.getItem("gestorRef");
      if (!ref) return;

      document.querySelectorAll("a[href]").forEach(link => {
        const href = link.getAttribute("href");
        if (href && !href.startsWith("http") && !href.includes("ref=")) {
          const sep = href.includes("?") ? "&" : "?";
          link.setAttribute("href", `${href}${sep}ref=${encodeURIComponent(ref)}`);
        }
      });

      // Mostrar carrito
      const cart = JSON.parse(localStorage.getItem("cart")) || [];
      const container = document.getElementById("cart-items");
      if (container) {
        container.innerHTML = cart.length === 0 
          ? "<p>Your cart is empty.</p>" 
          : "<ul>" + cart.map(item => `<li>${item.name} - $${item.price.toFixed(2)}</li>`).join('') + "</ul>";
      }
    });

    function toggleMenu() {
      document.getElementById("sideMenu").classList.toggle("active");
      document.getElementById("overlay").classList.toggle("active");
    }

    // ðŸ”¥ Cargar productos desde la API del bot
    fetch("https://pamicasa-bot-production.up.railway.app/api/productos")
      .then(res => res.json())
      .then(data => {
        const container = document.getElementById("product-container");
        container.innerHTML = "";

        data.forEach(product => {
          const card = document.createElement("div");
          card.className = "product-card";
          card.innerHTML = `
            <img src="${product.imagen}" alt="${product.nombre}" style="width:100%;height:auto;">
            <h3>${product.nombre}</h3>
            <p><strong>$${product.precio}</strong></p>
            <p>${product.descripcion}</p>
          `;
          container.appendChild(card);
        });
      })
      .catch(err => {
        console.error("Error al cargar productos:", err);
      });
  </script>

  <!-- MODAL DE UBICACIÃ“N -->
  <div id="ubicacion-modal" class="location-modal" style="display: none;">
    <h3>Selecciona tu ubicaciÃ³n</h3>
    <select id="select-provincia" required>
      <option value="">Selecciona una provincia</option>
      <option value="Artemisa">Artemisa</option>
      <option value="La Habana">La Habana</option>
      <option value="Mayabeque">Mayabeque</option>
    </select>
    <select id="select-municipio" required>
      <option value="">Selecciona un municipio</option>
    </select>
    <button onclick="guardarUbicacion()">Confirmar</button>
  </div>

</body>
</html>
